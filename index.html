<!DOCTYPE html>
<meta charset="utf-8">
<link rel='stylesheet' href='http://nvd3.org/assets/css/nv.d3.css'>
<style>

#chart svg {
  height: 400px;
}

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}

</style>
<body>
<div id="chart">
  <svg></svg>
</div>
<script src="http://nvd3.org/assets/lib/d3.v3.js"></script>
<script src="http://nvd3.org/assets/js/nv.d3.js"></script>
<script>

function data() {
  var icu2014Raw = [0, 0, 12, 15, 20, 29, 27, 31, 23, 21, 21, 10, 17, 7, 10, 4, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 4, 6, 5, 4, 2, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      fatal2014Raw = [0, 0, 5, 3, 7, 11, 15, 9, 11, 15, 15, 8, 12, 5, 6, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 4, 1, 2, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      icu2014 = [],
      fatal2014 = [],
      icu2015Raw = [0, 15, 22, 33, 52],
      fatal2015Raw = [0, 2, 8, 21, 33],
      icu2015 = [],
      fatal2015 = []
      ;
  
  for (var i = 0; i < 52; i++) {
    icu2014.push({x: i+1, y: icu2014Raw[i]});
    fatal2014.push({x: i+1, y: fatal2014Raw[i]});
    if (icu2015Raw[i] && fatal2015Raw[i]) {
        icu2015.push({x: i+1, y: (icu2015Raw[i] ? icu2015Raw[i] : 0)});
        fatal2015.push({x: i+1, y: (fatal2015Raw[i] ? fatal2015Raw[i] : 0)});
    }
  }

  return [
    {
      values: icu2014,
      key: '2014 ICU Admissions',
      color: '#ff7f0e'
    },
    {
      values: fatal2014,
      key: '2014 Fatal cases',
      color: '#2ca02c'
    },
    {
      values: icu2015,
      key: '2015 ICU Admissions',
      color: '#7f0eff'
    },
    {
      values: fatal2015,
      key: '2015 Fatal cases',
      color: '#2cdd2c'
    }
  ];
}

nv.addGraph(function() {
  var chart = nv.models.lineChart()
    .useInteractiveGuideline(true)
    ;

  chart.xAxis
    .axisLabel('Date (n-th week)')
    .tickFormat(d3.format(',r'))
    ;

  chart.yAxis
    .axisLabel('Count (person)')
    .tickFormat(d3.format(',r'))
    ;

  d3.select('#chart svg')
    .datum(data())
    .transition().duration(500)
    .call(chart)
    ;

  nv.utils.windowResize(chart.update);

  return chart;
});

</script>
